<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<!--
 WebSNES: HTML5 Audio/JavaScript version of "game music emu".

	In this case the WebAudio version of libGme had already been done by somebody else: http://onakasuita.org/jsgme/
	
	This page just provides the adapter/glue code to use it with my generic WebAudio player.
 
 	Copyright (C) 2016 Juergen Wothke

 Original C code of "LibGME" (see https://bitbucket.org/mpyne/game-music-emu/wiki/Home):

 Credits: The visualization used on this page was strongly "inspired" by this demo:
 http://html5-demos.appspot.com/static/webaudio/createMediaSourceElement.html

 LICENSE
 
 This library is free software; you can redistribute it and/or modify it
 under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2.1 of the License, or (at
 your option) any later version. This library is distributed in the hope
 that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public
 License along with this library; if not, write to the Free Software
 Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301 USA
-->
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<title>LibGme integration into my generic WebAudio player</title>

<link href="stdlib/font.css" rel="stylesheet" type="text/css">
<link href="stdlib/common.css" rel="stylesheet" type="text/css">
<link href="add_on.css" rel="stylesheet" type="text/css">

<link rel="image_src" href="screenshot.gif" />
<meta property="og:image" content="http://www.wothke.ch/websnes/screenshot.gif" />

<link rel="icon" href="favicon.ico" type="image/x-icon">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
<link type="image/x-icon" href="favicon.ico" />

<script type="text/javascript" src="stdlib/jquery1.11.min.js"></script>
<script type="text/javascript" src="stdlib/jquery.details.min.js"></script>
<script type="text/javascript" src="stdlib/scriptprocessor_player.min.js"></script>

<script>window.openDetails=false;</script>
<script type="text/javascript" src="stdlib/mini_display.js"></script>
<script type="text/javascript" src="stdlib/mini_controls.js"></script>

<script type="text/javascript" src="libgme.js"></script>
<script type="text/javascript" src="backend_libgme.js"></script>
<script>
var playerControls;
var	songDisplay;
	
// configure what music infos to display in SongDisplay
LibGMEDisplayAccessor = (function(){ var $this = function (doGetSongInfo) {
		$this.base.call(this, doGetSongInfo);
	}; 
	extend(DisplayAccessor, $this, {
		getDisplayTitle: function() 	{ return "libgme";},
		getDisplaySubtitle: function() 	{ return "lets play some music..";},
		getDisplayLine1: function() { return this.getSongInfo().game;},
		getDisplayLine2: function() { return this.getSongInfo().author; },
		getDisplayLine3: function() { return this.getSongInfo().copyright;; }
	});	return $this; })();
		
// link player events to "controls" and "display"
function doOnTrackEnd(){
	if (playerControls) playerControls.playNextSong();  
}
function doOnTrackReadyToPlay(){ 	
	ScriptNodePlayer.getInstance().play();
	songDisplay.redrawSongInfo();
}
function doOnPlayerReady() {
	if (playerControls) playerControls.playNextSong();
}

function init() {
	// --------------------------- LibGME music player -----------------------
	var basePath= '';		// not needed here
	ScriptNodePlayer.createInstance(new LibGmeBackendAdapter(), basePath, [], true, doOnPlayerReady,
										doOnTrackReadyToPlay, doOnTrackEnd);
		
	// --------------------------- UI - basic player controls --------------
	var songs = [
		'music/add-your-music-here.spc',
	];
	playerControls= new BasicPlayerControls(songs, true, false,
				(function(someSong) {
						var options= {};
						return [someSong, options];
					})
				);

	// limit rendering to 50% of the available time (LibGME is fast so there is no need ..)
	songDisplay= new SongDisplay(new LibGMEDisplayAccessor((function(){return playerControls.getSongInfo();})), 
								[0x6565e6], 0, 0.5, (function(){playerControls.animate()}));

	playerControls.playNextSong();
}
</script>
<script type="text/javascript" src="stdlib/analytics.js"></script>
</head>

<body onload="init();">
<div class="tooltip" id="tooltip" alt= "This is a hobby project, but it costs not only time to regularily maintain this site but also money to pay for the internet service provider (etc). If you want to keep this site up and running.. or if you just like my work (see https://jwothke.wordpress.com/) and you'd like to see more of it in the future, please make a contribution. Thank you!"></div>

<details>
  <summary>What's this?</summary>
  <div>
  <p>LibGme (http://onakasuita.org/jsgme/) integration into my generic WebAudio player.</p>
 
  <p>Bring your own files by dropping them onto the bullseye.</p>
 
  <p>2016 by Juergen Wothke  (The source code can be found <a target="_blank" href="https://github.com/wothke/">here</a>.)</p>
 
  <p>Please use the below controls to navigate between the songs that you have dropped on the player:
  <span id="controls"></span>
 </div>
</details>
<aside></aside>
<section>
  <div id="logo" class="logo">
	<div id="moz-reflect-logo"><canvas  id="logoCanvas"  width="600" height="250"></canvas></div>
  </div>
  <div id="spectrum" class="spectrum">
  	<div id="moz-reflect-spectrum"><canvas id="spectrumCanvas" width="512" height="200"></canvas></div>
  </div>
  <div id="drop" class="drop"><img src="target.gif" width=200 height=200/></div><!--see BasicPlayerControls-->
</section>
</body>
</html>
